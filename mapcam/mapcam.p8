pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
map={}
map[1 ]={1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 }
map[2 ]={1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[3 ]={1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1 }
map[4 ]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1 }
map[5 ]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[6 ]={1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1 }
map[7 ]={1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,1 }
map[8 ]={1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[9 ]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[10]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[11]={1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[12]={1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1 }
map[13]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[14]={1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1 }
map[15]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[16]={1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[17]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[18]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1 }
map[19]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 }
map[20]={1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 }
map.xcamoffset=0
map.ycamoffset=16
map.xcam=0
map.ycam=0

player={}
player.xdraw=128/2
player.ydraw=128/2+map.xcamoffset
player.tile=nil

function _init()
end

function _draw()
  cls()
  camera(0,0)
  clip()
  print ("mapcam ")
  if player.tile~=nil then
    print(player.tile)
  end 
  draw_map()
  draw_player()
end 

function draw_player()
  camera(0,0)
  spr(1,player.xdraw,player.ydraw)
end

function draw_map()
  clip(0,16,128,140)
  camera(map.xcam-map.xcamoffset,map.ycam-map.ycamoffset)
  for y=1,#map do
    for x=1,#map[y] do
      if map[y][x]==1 then
        spr(0,((x-1)*8),((y-1)*8))
      end
    end
  end
end

function fetch_map_tile(xd, yd)
  xt=ceil((player.xdraw+map.xcam)/8)
  yt=ceil((player.ydraw+map.ycam-map.ycamoffset)/8)
  xt+=1+xd
  yt+=1+yd
  printh (xt.."-"..yt)
  return map[yt][xt]
end

function _update() 
    if (btn(0)) then  
      map.xcam-=1
      player.tile=fetch_map_tile(-1,0)
    end 
    if (btn(1)) then 
      map.xcam+=1
      player.tile=fetch_map_tile(0,0)
    end
    if (btn(2)) then 
      map.ycam-=1
      player.tile=fetch_map_tile(0,-1)
    end
    if (btn(3)) then 
      map.ycam+=1
      player.tile=fetch_map_tile(0,0)      
    end
end


__gfx__
44444044000990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444044000990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44044444666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44044444606666060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444044060000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444044660000660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
